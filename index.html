<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Replit Web Embedder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { margin: 0; font-family: sans-serif; }
    #toolbar { position: fixed; top: 10px; left: 10px; background: #222; color: #fff; padding: 10px; border-radius: 8px; z-index: 9999; }
    #toolbar.hidden { transform: translateX(-110%); transition: transform 0.3s; }
    #toggleToolbar { position: absolute; top: 50%; right: -30px; transform: translateY(-50%); background: #222; color: #fff; padding: 8px; border-radius: 0 4px 4px 0; cursor: pointer; }
    .settings { display: none; margin-top: 10px; }
    .settings.visible { display: block; }
    label { display: block; margin-bottom: 5px; }
    #content { padding-top: 120px; }
  </style>
</head>
<body>
  <div id="toolbar">
    <button id="toggleToolbar">☰</button>
    <input id="siteUrl" placeholder="https://example.com" style="width:250px" />
    <button onclick="loadSite()">Load</button>
    <button id="toggleClicker">Start Clicker</button>
    <button id="advancedBtn">Advanced ▼</button>
    <div class="settings">
      <label>Click Speed (ms): <input type="number" id="clickSpeed" value="50" min="10" max="1000"></label>
      <label>Click Mode: 
        <select id="clickMode">
          <option value="single">Single</option>
          <option value="double">Double</option>
        </select>
      </label>
      <label>Hotkey (Ctrl+): <input id="hotkey" value="C" maxlength="1" style="width:20px" /></label>
    </div>
  </div>
  <div id="content">Website will appear here...</div>

  <script>
    const $ = id => document.getElementById(id);
    let lastX = 0, lastY = 0, clicking = false, intervalId;

    document.addEventListener("mousemove", e => (lastX = e.clientX, lastY = e.clientY));
    document.addEventListener("keydown", e => e.ctrlKey && e.key.toUpperCase() === $('hotkey').value.toUpperCase() && $('toggleClicker').click());

    $('toggleToolbar').onclick = () => $('toolbar').classList.toggle('hidden');
    $('advancedBtn').onclick = () => {
      const s = document.querySelector('.settings');
      s.classList.toggle('visible');
      $('advancedBtn').textContent = s.classList.contains('visible') ? 'Advanced ▼' : 'Advanced ►';
    };

    function loadSite() {
      const url = $('siteUrl').value.trim();
      if (!url) return $('content').innerHTML = 'Please enter a URL';
      const iframe = document.createElement('iframe');
      Object.assign(iframe.style, { width: '100%', height: '100vh', border: 'none' });
      iframe.src = encodeURI(url);
      $('content').innerHTML = ''; $('content').appendChild(iframe);
    }

    function simulateClick(el) {
      if (!el || $('toolbar').contains(el)) return;
      ['mousedown', 'mouseup'].forEach(evt => el.dispatchEvent(new MouseEvent(evt, { bubbles: true, cancelable: true })));
      el.click();
      if ($('clickMode').value === 'double') setTimeout(() => el.click(), 50);
    }

    $('toggleClicker').onclick = () => {
      clicking = !clicking;
      $('toggleClicker').textContent = clicking ? 'Stop Clicker' : 'Start Clicker';
      if (clicking) {
        intervalId = setInterval(() => {
          const iframe = document.querySelector('iframe');
          if (!iframe) return;
          try {
            iframe.contentWindow.postMessage({ type: 'click', x: lastX, y: lastY - iframe.getBoundingClientRect().top, isDouble: $('clickMode').value === 'double' }, '*');
            simulateClick(document.elementFromPoint(lastX, lastY));
          } catch (e) { console.warn('Click error:', e); }
        }, +$('clickSpeed').value);
      } else clearInterval(intervalId);
    };
  </script>
</body>
</html>
